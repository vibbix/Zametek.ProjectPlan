using Microsoft.Xaml.Behaviors;
using System.Windows;
using System.Windows.Input;


namespace Zametek.View.ProjectPlan.Miscellaneous;
public class EventToCommand
        : TriggerAction<DependencyObject>
{
    /// <summary>
    /// Identifies the <see cref="CommandParameter" /> dependency property
    /// </summary>
    public static readonly DependencyProperty CommandParameterProperty =
       DependencyProperty.Register("CommandParameter", typeof(object), typeof(EventToCommand));

    /// <summary>
    /// Identifies the <see cref="Command" /> dependency property
    /// </summary>
    public static readonly DependencyProperty CommandProperty =
       DependencyProperty.Register("Command", typeof(ICommand), typeof(EventToCommand));

    /// <summary>
    /// Gets or sets the ICommand that this trigger is bound to. This
    /// is a DependencyProperty.
    /// </summary>
    public ICommand Command
    {
        get
        {
            return (ICommand)GetValue(CommandProperty);
        }

        set
        {
            SetValue(CommandProperty, value);
        }
    }

    /// <summary>
    /// Gets or sets an object that will be passed to the <see cref="Command" />
    /// attached to this trigger. This is a DependencyProperty.
    /// </summary>
    public object CommandParameter
    {
        get
        {
            return GetValue(CommandParameterProperty);
        }
        set
        {
            SetValue(CommandParameterProperty, value);
        }
    }

    /// <summary>
    /// Specifies whether the EventArgs of the event that triggered this
    /// action should be passed to the bound RelayCommand. If this is true,
    /// the command should accept arguments of the corresponding
    /// type (for example RelayCommand&lt;MouseButtonEventArgs&gt;).
    /// </summary>
    public bool PassEventArgsToCommand
    {
        get;
        set;
    }

    /// <summary>
    /// Executes the trigger.
    /// <para>To access the EventArgs of the fired event, use a RelayCommand&lt;EventArgs&gt;
    /// and leave the CommandParameter and CommandParameterValue empty!</para>
    /// </summary>
    /// <param name="parameter">The EventArgs of the fired event.</param>
    protected override void Invoke(object parameter)
    {
        var command = Command;
        var commandParameter = CommandParameter;
        if (command == null)
        {
            return;
        }
        if (commandParameter == null
           && PassEventArgsToCommand)
        {
            commandParameter = parameter;
        }
        if (command.CanExecute(commandParameter))
        {
            command.Execute(commandParameter);
        }
    }
}
